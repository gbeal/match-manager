# Story 1.2: Team and Player Data Management

## Status
Draft

## Story
**As a** volunteer coach,
**I want** to create and manage my team roster with player names and basic information,
**so that** I can digitally organize my team before moving to advanced game management.

## Acceptance Criteria
1. Create team with team name and basic configuration settings
2. Add players to roster with name, jersey number, and availability status
3. Edit and remove players from team roster as needed
4. All team and player data persists locally using IndexedDB for offline storage
5. Data remains available after app restart or device reboot
6. Simple, touch-optimized interface for roster management
7. Validation prevents duplicate jersey numbers within team

## Tasks / Subtasks
- [ ] Task 1: Create Team Data Models and Types (AC: 1, 4)
  - [ ] Define Team TypeScript interface in packages/shared/src/types/team.ts
  - [ ] Define Player TypeScript interface in packages/shared/src/types/game.ts
  - [ ] Add position enum with goalkeeper, defender, midfielder, forward
  - [ ] Export types from packages/shared/src/types/index.ts
- [ ] Task 2: Implement IndexedDB Schema for Teams and Players (AC: 4, 5)
  - [ ] Create database schema definition in src/services/persistence/schema.ts
  - [ ] Implement TeamRepository class for CRUD operations
  - [ ] Implement PlayerRepository class with jersey number validation
  - [ ] Add database initialization in src/services/persistence/database.ts
- [ ] Task 3: Create Team Setup Components (AC: 1, 6)
  - [ ] Build TeamSetup component in src/components/setup/TeamSetup/
  - [ ] Create TeamForm with name input and touch-optimized controls
  - [ ] Add team settings configuration (default formation, strategy preferences)
  - [ ] Implement form validation and error handling
- [ ] Task 4: Create Player Management Components (AC: 2, 3, 6, 7)
  - [ ] Build PlayerSetup component in src/components/setup/PlayerSetup/
  - [ ] Create PlayerForm with name, jersey number, availability inputs
  - [ ] Add player list with edit/delete functionality
  - [ ] Implement jersey number uniqueness validation
  - [ ] Add touch-optimized interaction patterns (minimum 44px targets)
- [ ] Task 5: Implement Team Context and State Management (AC: 1, 2, 3)
  - [ ] Create TeamContext in src/stores/TeamContext.tsx
  - [ ] Add team and player state management with useReducer
  - [ ] Implement optimistic updates for immediate UI feedback
  - [ ] Add persistence integration for all state changes
- [ ] Task 6: Create Navigation and Routes (AC: 6)
  - [ ] Add team management routes in src/app/teams/
  - [ ] Create team list page at src/app/teams/page.tsx
  - [ ] Add team detail page at src/app/teams/[teamId]/page.tsx
  - [ ] Implement player management page at src/app/teams/[teamId]/players/page.tsx
- [ ] Task 7: Add Data Validation and Error Handling (AC: 7)
  - [ ] Create validation schemas using Zod in packages/shared/src/schemas/
  - [ ] Add client-side validation for all forms
  - [ ] Implement error boundaries for graceful failure handling
  - [ ] Add user feedback for validation errors
- [ ] Task 8: Testing Implementation (AC: All)
  - [ ] Write component tests for TeamSetup and PlayerSetup
  - [ ] Add repository tests for IndexedDB operations
  - [ ] Create E2E tests for complete team/player management workflow
  - [ ] Test offline persistence and data recovery

## Dev Notes

### Previous Story Insights
No previous story exists - this is the first story in Epic 1.

### Data Models
**Team Interface** [Source: architecture/data-models.md#team]:
```typescript
interface Team {
  id: string;
  name: string;
  createdAt: Date;
  updatedAt: Date;
  settings: TeamSettings;
}

interface TeamSettings {
  defaultFormation: Formation;
  preferredStrategy: SubstitutionStrategy;
  defaultShiftLength: number; // minutes
  advanceWarningTime: number; // minutes
}
```

**Player Interface** [Source: architecture/data-models.md#player]:
```typescript
interface Player {
  id: string;
  teamId: string;
  name: string;
  jerseyNumber: number;
  positions: Position[];
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
}

type Position = 'goalkeeper' | 'defender' | 'midfielder' | 'forward';
```

### API Specifications
No API endpoints required for MVP - operates offline-first with IndexedDB storage only [Source: architecture/external-apis.md#current-mvp-status].

### Component Specifications
**Component Organization** [Source: architecture/frontend-architecture.md#component-organization]:
- Setup components in `src/components/setup/`
- TeamSetup and PlayerSetup follow standard component template
- Touch-optimized with minimum 44px targets [Source: architecture/coding-standards.md#critical-fullstack-rules]
- Use React Context + useReducer for state management

**PWA Shell Integration** [Source: architecture/components.md#pwa-shell-component]:
- All features must work offline-first
- Integration with OfflineContext for network status

### File Locations
Based on project structure [Source: architecture/unified-project-structure.md]:
- Types: `packages/shared/src/types/`
- Components: `src/components/setup/TeamSetup/`, `src/components/setup/PlayerSetup/`
- State: `src/stores/TeamContext.tsx`
- Persistence: `src/services/persistence/`
- Routes: `src/app/teams/`
- Tests: `tests/components/`, `tests/services/`, `tests/e2e/`

### Testing Requirements
**Test Organization** [Source: architecture/testing-strategy.md#test-organization]:
- Component tests in `tests/components/` using Jest + React Testing Library
- Service tests in `tests/services/` for repository pattern validation
- E2E tests in `tests/e2e/` using Playwright for complete workflows

**Test Standards** [Source: architecture/testing-strategy.md#test-examples]:
- Component tests must verify accessibility (screen reader support)
- Repository tests must validate IndexedDB operations and constraints
- E2E tests must verify offline functionality and data persistence

### Technical Constraints
- TypeScript strict mode enabled [Source: architecture/tech-stack.md]
- All state updates must be immutable [Source: architecture/coding-standards.md#critical-fullstack-rules]
- IndexedDB access only through repository pattern [Source: architecture/coding-standards.md#critical-fullstack-rules]
- Touch optimization required for mobile-first design [Source: architecture/coding-standards.md#critical-fullstack-rules]

### Testing
**Testing Standards:**
- Test files located in `tests/components/`, `tests/services/`, `tests/e2e/`
- Use Jest + React Testing Library for component tests [Source: architecture/testing-strategy.md]
- Use Playwright for E2E testing with PWA support [Source: architecture/tech-stack.md]
- All interactive elements must be tested for 44px minimum touch targets
- IndexedDB persistence must be tested for offline functionality
- Repository pattern tests required for data validation and constraints

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-14 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled during development*

### Debug Log References
*To be filled during development*

### Completion Notes List
*To be filled during development*

### File List
*To be filled during development*

## QA Results
*Results from QA Agent review will be populated here after implementation*